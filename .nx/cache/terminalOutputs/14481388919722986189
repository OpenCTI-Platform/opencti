> python worker.py

{"timestamp": "2026-01-15T10:12:10.219927Z", "level": "INFO", "name": "api", "message": "Getting connectors ..."}
{"timestamp": "2026-01-15T10:12:10.238142Z", "level": "ERROR", "name": "worker", "message": "ConnectionError", "exc_info": "Traceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connection.py\", line 204, in _new_conn\n    sock = connection.create_connection(\n        (self._dns_host, self.port),\n    ...<2 lines>...\n        socket_options=self.socket_options,\n    )\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/util/connection.py\", line 85, in create_connection\n    raise err\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/util/connection.py\", line 73, in create_connection\n    sock.connect(sa)\n    ~~~~~~~~~~~~^^^^\nConnectionRefusedError: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connectionpool.py\", line 787, in urlopen\n    response = self._make_request(\n        conn,\n    ...<10 lines>...\n        **response_kw,\n    )\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connectionpool.py\", line 493, in _make_request\n    conn.request(\n    ~~~~~~~~~~~~^\n        method,\n        ^^^^^^^\n    ...<6 lines>...\n        enforce_content_length=enforce_content_length,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connection.py\", line 500, in request\n    self.endheaders()\n    ~~~~~~~~~~~~~~~^^\n  File \"/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py\", line 1353, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py\", line 1113, in _send_output\n    self.send(msg)\n    ~~~~~~~~~^^^^^\n  File \"/opt/homebrew/Cellar/python@3.14/3.14.2/Frameworks/Python.framework/Versions/3.14/lib/python3.14/http/client.py\", line 1057, in send\n    self.connect()\n    ~~~~~~~~~~~~^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connection.py\", line 331, in connect\n    self.sock = self._new_conn()\n                ~~~~~~~~~~~~~~^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connection.py\", line 219, in _new_conn\n    raise NewConnectionError(\n        self, f\"Failed to establish a new connection: {e}\"\n    ) from e\nurllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/requests/adapters.py\", line 644, in send\n    resp = conn.urlopen(\n        method=request.method,\n    ...<9 lines>...\n        chunked=chunked,\n    )\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/connectionpool.py\", line 841, in urlopen\n    retries = retries.increment(\n        method, url, error=new_e, _pool=self, _stacktrace=sys.exc_info()[2]\n    )\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/urllib3/util/retry.py\", line 519, in increment\n    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/opencti/opencti-worker/src/worker.py\", line 257, in start\n    connectors: List[Any] = self.api.connector.list()\n                            ~~~~~~~~~~~~~~~~~~~~~~~^^\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_connector.py\", line 88, in list\n    result = self.api.query(query)\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_client.py\", line 576, in query\n    r = self.session.post(\n        self.api_url,\n    ...<5 lines>...\n        timeout=self.session_requests_timeout,\n    )\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/requests/sessions.py\", line 637, in post\n    return self.request(\"POST\", url, data=data, json=json, **kwargs)\n           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/requests/sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/requests/sessions.py\", line 703, in send\n    r = adapter.send(request, **kwargs)\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.14/site-packages/requests/adapters.py\", line 677, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))", "attributes": {"reason": "HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))"}}
{"timestamp": "2026-01-15T10:12:23.863766Z", "level": "INFO", "name": "worker", "message": "Thread for worker terminated"}
