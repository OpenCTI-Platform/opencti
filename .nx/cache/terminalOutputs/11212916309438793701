> python worker.py

{"timestamp": "2026-01-29T10:19:05.873195Z", "level": "INFO", "name": "api", "message": "Getting connectors ..."}
{"timestamp": "2026-01-29T10:19:05.954089Z", "level": "ERROR", "name": "worker", "message": "ConnectionError", "exc_info": "Traceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 204, in _new_conn\n    sock = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/connection.py\", line 85, in create_connection\n    raise err\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/connection.py\", line 73, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 787, in urlopen\n    response = self._make_request(\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 493, in _make_request\n    conn.request(\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 500, in request\n    self.endheaders()\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1331, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1091, in _send_output\n    self.send(msg)\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1035, in send\n    self.connect()\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 331, in connect\n    self.sock = self._new_conn()\n                ^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 219, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/adapters.py\", line 644, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 841, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/retry.py\", line 535, in increment\n    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/opencti/opencti-worker/src/worker.py\", line 257, in start\n    connectors: List[Any] = self.api.connector.list()\n                            ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_connector.py\", line 101, in list\n    result = self.api.query(query)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_client.py\", line 711, in query\n    r = self.session.post(\n        ^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 637, in post\n    return self.request(\"POST\", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 703, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/adapters.py\", line 677, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))", "attributes": {"reason": "HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))"}}
{"timestamp": "2026-01-29T10:20:05.956746Z", "level": "INFO", "name": "api", "message": "Getting connectors ..."}
{"timestamp": "2026-01-29T10:20:05.971021Z", "level": "ERROR", "name": "worker", "message": "ConnectionError", "exc_info": "Traceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 204, in _new_conn\n    sock = connection.create_connection(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/connection.py\", line 85, in create_connection\n    raise err\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/connection.py\", line 73, in create_connection\n    sock.connect(sa)\nConnectionRefusedError: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 787, in urlopen\n    response = self._make_request(\n               ^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 493, in _make_request\n    conn.request(\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 500, in request\n    self.endheaders()\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1331, in endheaders\n    self._send_output(message_body, encode_chunked=encode_chunked)\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1091, in _send_output\n    self.send(msg)\n  File \"/Users/florian.delemarre/.pyenv/versions/3.12.7/lib/python3.12/http/client.py\", line 1035, in send\n    self.connect()\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 331, in connect\n    self.sock = self._new_conn()\n                ^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connection.py\", line 219, in _new_conn\n    raise NewConnectionError(\nurllib3.exceptions.NewConnectionError: HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/adapters.py\", line 644, in send\n    resp = conn.urlopen(\n           ^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/connectionpool.py\", line 841, in urlopen\n    retries = retries.increment(\n              ^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/urllib3/util/retry.py\", line 535, in increment\n    raise MaxRetryError(_pool, url, reason) from reason  # type: ignore[arg-type]\n    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nurllib3.exceptions.MaxRetryError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/Users/florian.delemarre/filigran/octi/opencti/opencti-worker/src/worker.py\", line 257, in start\n    connectors: List[Any] = self.api.connector.list()\n                            ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_connector.py\", line 101, in list\n    result = self.api.query(query)\n             ^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/opencti/client-python/pycti/api/opencti_api_client.py\", line 711, in query\n    r = self.session.post(\n        ^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 637, in post\n    return self.request(\"POST\", url, data=data, json=json, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 589, in request\n    resp = self.send(prep, **send_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/sessions.py\", line 703, in send\n    r = adapter.send(request, **kwargs)\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/florian.delemarre/filigran/octi/.python-venv/lib/python3.12/site-packages/requests/adapters.py\", line 677, in send\n    raise ConnectionError(e, request=request)\nrequests.exceptions.ConnectionError: HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))", "attributes": {"reason": "HTTPConnectionPool(host='localhost', port=4000): Max retries exceeded with url: /graphql (Caused by NewConnectionError(\"HTTPConnection(host='localhost', port=4000): Failed to establish a new connection: [Errno 61] Connection refused\"))"}}
{"timestamp": "2026-01-29T10:21:05.975892Z", "level": "INFO", "name": "api", "message": "Getting connectors ..."}
{"timestamp": "2026-01-29T10:21:06.034805Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.049241Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_bf7619c6-48da-4ccb-bd9d-4cbea1c7a186"}}
{"timestamp": "2026-01-29T10:21:06.049576Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.062047Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_d917735a-2277-595a-93ba-bd2637c7feb4"}}
{"timestamp": "2026-01-29T10:21:06.062585Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.071629Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_d336676c-4ee5-4257-96ff-b2a86688d4af"}}
{"timestamp": "2026-01-29T10:21:06.071936Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.081143Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_c194e700-afb6-4c4e-ad1b-d4a00590e735"}}
{"timestamp": "2026-01-29T10:21:06.081519Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.092666Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_background-task-0"}}
{"timestamp": "2026-01-29T10:21:06.093036Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.103742Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_background-task-1"}}
{"timestamp": "2026-01-29T10:21:06.104207Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.114006Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_background-task-2"}}
{"timestamp": "2026-01-29T10:21:06.114297Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.121875Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_background-task-3"}}
{"timestamp": "2026-01-29T10:21:06.122277Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.130098Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_e4109cdf-a84c-43ca-9777-576fdbebed46"}}
{"timestamp": "2026-01-29T10:21:06.130401Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.137765Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_sync"}}
{"timestamp": "2026-01-29T10:21:06.139922Z", "level": "INFO", "name": "api", "message": "Health check (platform version)..."}
{"timestamp": "2026-01-29T10:21:06.147284Z", "level": "INFO", "name": "worker", "message": "Thread for queue started", "attributes": {"consumer_type": "push", "queue": "push_playbook"}}
{"timestamp": "2026-01-29T10:22:00.109640Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_bf7619c6-48da-4ccb-bd9d-4cbea1c7a186"}}
{"timestamp": "2026-01-29T10:22:00.119770Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_d917735a-2277-595a-93ba-bd2637c7feb4"}}
{"timestamp": "2026-01-29T10:22:00.133395Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_c194e700-afb6-4c4e-ad1b-d4a00590e735"}}
{"timestamp": "2026-01-29T10:22:00.171210Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_background-task-0"}}
{"timestamp": "2026-01-29T10:22:00.171625Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_background-task-1"}}
{"timestamp": "2026-01-29T10:22:00.200587Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_background-task-2"}}
{"timestamp": "2026-01-29T10:22:00.200822Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_playbook"}}
{"timestamp": "2026-01-29T10:22:00.201161Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_d336676c-4ee5-4257-96ff-b2a86688d4af"}}
{"timestamp": "2026-01-29T10:22:00.201435Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_sync"}}
{"timestamp": "2026-01-29T10:22:00.201555Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_background-task-3"}}
{"timestamp": "2026-01-29T10:22:00.201627Z", "level": "INFO", "name": "worker", "message": "Thread for queue terminated", "attributes": {"consumer_type": "push", "queue": "push_e4109cdf-a84c-43ca-9777-576fdbebed46"}}
{"timestamp": "2026-01-29T10:22:00.201746Z", "level": "INFO", "name": "worker", "message": "Thread for worker terminated"}
