# coding: utf-8


def test_malware_import_with_sample_refs(api_client):
    with open("tests/data/basicMalwareWithSample.json", "r") as content_file:
        content = content_file.read()

    imported_malware_bundle, _ = api_client.stix2.import_bundle_from_json(
        json_data=content
    )
    assert imported_malware_bundle is not None

    for importObject in imported_malware_bundle:
        if importObject["type"] == "malware":
            assert (
                api_client.malware.read(id=importObject["id"]).get("samples") is not []
            )
