type MalwareAnalysis implements BasicObject & StixCoreObject & StixDomainObject & StixObject{
    # BasicObject
    id: ID! # internal_id
    standard_id: String!
    entity_type: String!
    parent_types: [String]!
    metrics:[Metric]
    # StixObject
    representative: Representative!
    x_opencti_stix_ids: [StixId]
    is_inferred: Boolean!
    spec_version: String!
    created_at: DateTime!
    updated_at: DateTime!
    refreshed_at: DateTime
    x_opencti_inferences: [Inference]
    draftVersion: DraftVersion
    # StixCoreObject
    createdBy: Identity
    numberOfConnectedElement: Int!
    objectMarking: [MarkingDefinition!]
    objectOrganization: [Organization!]
    objectLabel: [Label!]
    externalReferences(first: Int): ExternalReferenceConnection
    containersNumber: Number
    containers(first: Int, entityTypes: [String!]): ContainerConnection
    reports(first: Int): ReportConnection
    notes(first: Int): NoteConnection
    opinions(first: Int): OpinionConnection
    observedData(first: Int): ObservedDataConnection
    groupings(first: Int): GroupingConnection
    cases(first: Int): CaseConnection
    stixCoreRelationships(
        first: Int
        after: ID
        orderBy: StixCoreRelationshipsOrdering
        orderMode: OrderingMode
        fromId: StixRef
        toId: StixRef
        fromTypes: [String]
        toTypes: [String]
        relationship_type: String
        startTimeStart: DateTime
        startTimeStop: DateTime
        stopTimeStart: DateTime
        stopTimeStop: DateTime
        firstSeenStart: DateTime
        firstSeenStop: DateTime
        lastSeenStart: DateTime
        lastSeenStop: DateTime
        confidences: [Int]
        search: String
        filters: FilterGroup
    ): StixCoreRelationshipConnection
    stixCoreObjectsDistribution(
        relationship_type: [String]
        toTypes: [String]
        field: String!
        startDate: DateTime
        endDate: DateTime
        dateAttribute: String
        operation: StatsOperation!
        limit: Int
        order: String
        types: [String]
        filters: FilterGroup
        search: String
    ): [Distribution] @auth(for: [KNOWLEDGE, EXPLORE])
    stixCoreRelationshipsDistribution(
        field: String!
        operation: StatsOperation!
        startDate: DateTime
        endDate: DateTime
        dateAttribute: String
        isTo: Boolean
        limit: Int
        order: String
        elementWithTargetTypes: [String]
        fromId: [String]
        fromRole: String
        fromTypes: [String]
        toId: [String]
        toRole: String
        toTypes: [String]
        relationship_type: [String]
        confidences: [Int]
        search: String
        filters: FilterGroup
    ): [Distribution] @auth(for: [KNOWLEDGE, EXPLORE])
    opinions_metrics: OpinionsMetrics
    # StixDomainObject
    revoked: Boolean!
    confidence: Int
    lang: String
    created: DateTime
    modified: DateTime
    x_opencti_graph_data: String
    objectAssignee: [Assignee!]
    objectParticipant: [Participant!]
    avatar: OpenCtiFile
    # Technical
    creators: [Creator!]
    toStix(version: Version): String
    importFiles(
    first: Int
    prefixMimeType: String
    after: ID
    orderBy: FileOrdering
    orderMode: OrderingMode
    search: String
    filters: FilterGroup
  ): FileConnection
    pendingFiles(
    first: Int
    after: ID
    orderBy: FileOrdering
    orderMode: OrderingMode
    search: String
    filters: FilterGroup
  ): FileConnection
    exportFiles(first: Int): FileConnection
    editContext: [EditUserContext!]
    connectors(onlyAlive: Boolean): [Connector]
    jobs(first: Int): [Work]
    status: Status
    workflowEnabled: Boolean
    pirInformation(pirId: ID!): PirInformation @auth(for: [PIRAPI])
    # Malware Analysis
    product: String!
    version: String
    hostVm: Software
    operatingSystem: Software
    installedSoftware: SoftwareConnection
    configuration_version: String
    modules: [String!]
    analysis_engine_version: String
    analysis_definition_version: String
    submitted: DateTime
    analysis_started: DateTime
    analysis_ended: DateTime
    result_name: String!
    result: String
    analysisSco: StixCyberObservableConnection
    sample: StixCyberObservable
}

# Queries
type Query {
    malwareAnalysis(id: String!): MalwareAnalysis @auth(for: [KNOWLEDGE])
    malwareAnalyses(
        first: Int
        after: ID
        orderBy: MalwareAnalysesOrdering
        orderMode: OrderingMode
        filters: FilterGroup
        search: String
    ): MalwareAnalysisConnection @auth(for: [KNOWLEDGE])
}

enum MalwareAnalysesOrdering {
    result_name
    product
    operatingSystem
    creator
    createdBy
    objectLabel
    submitted
    objectMarking
    x_opencti_workflow_id
    confidence
    _score
}

# Relay connections
type MalwareAnalysisConnection {
    pageInfo: PageInfo!
    edges: [MalwareAnalysisEdge!]
}
type MalwareAnalysisEdge {
    cursor: String!
    node: MalwareAnalysis!
}

# Mutations
input MalwareAnalysisAddInput {
    stix_id: StixId
    x_opencti_stix_ids: [StixId]
    # Malware Analysis
    product: String!
    version: String
    hostVm: String
    operatingSystem: String
    installedSoftware: [String]
    configuration_version: String
    modules: [String]
    analysis_engine_version: String
    analysis_definition_version: String
    submitted: DateTime
    analysis_started: DateTime
    analysis_ended: DateTime
    result_name: String!
    result: String
    analysisSco: [String]
    analysisSample: String
    created: DateTime
    modified: DateTime
    # Other elements
    confidence: Int
    revoked: Boolean
    lang: String
    createdBy: String
    objectMarking: [String]
    objectAssignee: [String]
    externalReferences: [String]
    objectOrganization: [String]
    objectLabel: [String]
    clientMutationId: String
    x_opencti_workflow_id: String
    update: Boolean
    file: Upload
}

type Mutation {
    malwareAnalysisAdd(input: MalwareAnalysisAddInput!): MalwareAnalysis @auth(for: [KNOWLEDGE_KNUPDATE])
    malwareAnalysisDelete(id: ID!): ID @auth(for: [KNOWLEDGE_KNUPDATE_KNDELETE])
    malwareAnalysisFieldPatch(id: ID!, input: [EditInput]!, commitMessage: String, references: [String]): MalwareAnalysis @auth(for: [KNOWLEDGE_KNUPDATE])
    malwareAnalysisContextPatch(id: ID!, input: EditContext!): MalwareAnalysis @auth(for: [KNOWLEDGE_KNUPDATE])
    malwareAnalysisContextClean(id: ID!): MalwareAnalysis @auth(for: [KNOWLEDGE_KNUPDATE])
    malwareAnalysisRelationAdd(id: ID!, input: StixRefRelationshipAddInput!): StixRefRelationship @auth(for: [KNOWLEDGE_KNUPDATE])
    malwareAnalysisRelationDelete(id: ID!, toId: StixRef!, relationship_type: String!): MalwareAnalysis @auth(for: [KNOWLEDGE_KNUPDATE])
}
