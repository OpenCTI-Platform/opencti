### Directives
directive @auth(for: UserRole = ROLE_USER) on OBJECT | FIELD_DEFINITION
directive @constraint(
  # String constraints
  minLength: Int
  maxLength: Int
  startsWith: String
  endsWith: String
  notContains: String
  pattern: String
  format: String

  # Number constraints
  min: Int
  max: Int
  exclusiveMin: Int
  exclusiveMax: Int
  multipleOf: Int
) on INPUT_FIELD_DEFINITION

### Scalar
scalar DateTime
scalar ConstraintString
scalar ConstraintNumber

### Upload
input Upload {
  name: String!
  type: String!
  size: Int!
  base64: String!
}

### Relations
type RelationEmbedded {
  id: ID!
  entity_type: String!
}

type RelationData {
  node: GlobalObject
  relation: RelationEmbedded
}

type createdByRef {
  node: Identity
  relation: RelationEmbedded
}

type ownedBy {
  node: User
  relation: RelationEmbedded
}

### Relay
type PageInfo {
  startCursor: String!
  endCursor: String!
  hasNextPage: Boolean!
  hasPreviousPage: Boolean!
  globalCount: Int!
}
enum OrderingMode {
  asc
  desc
}

### Edit
input EntityRelation {
  entityType: String
  relationType: String
  relationRole: String
}
input EditInput {
  id: ID # ID of the instance in edition
  key: String! # Field name to change
  value: [String]! # Values to apply
}
input EditContext {
  focusOn: String # Field name
}
type EditUserContext {
  name: String!
  focusOn: String # Field name
}

### Stats
enum StatsOperation {
  count
  sum
}
type TimeSeries {
  date: DateTime!
  value: Int!
}
type Distribution {
  label: String!
  value: Int!
}
type Number {
  total: Int!
  count: Int!
}

### Settings
type Settings {
  id: ID!
  platform_title: String
  platform_email: String
  platform_url: String
  platform_language: String
  platform_external_auth: Boolean
  platform_registration: Boolean
  editContext: [EditUserContext]
  created_at: DateTime
  updated_at: DateTime
}
input SettingsAddInput {
  platform_title: String
  platform_email: String
  platform_url: String
  platform_language: String
  platform_external_auth: Boolean
  platform_registration: Boolean
}

### Export
type Export {
  id: ID!
  description: String
  object_status: Int
  export_type: String
  raw_data: String
  created_at: DateTime
}

### Global objects
interface GlobalObject {
  id: ID!
  internal_id: String!
  entity_type: String!
}

### STIX objects
interface StixEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  description: String
  created_at: DateTime
  updated_at: DateTime
}

enum StixDomainEntitiesOrdering {
  name
  entity_type
  created_at
  updated_at
}
type StixDomainEntityConnection {
  pageInfo: PageInfo!
  edges: [StixDomainEntityEdge]
}
type StixDomainEntityEdge {
  cursor: String!
  node: StixDomainEntity!
  relation: RelationEmbedded!
}
interface StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  description: String
  alias: [String]
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input StixDomainEntityAddInput {
  internal_id: String
  name: String!
  description: String
  type: String!
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### STIX obseravables
enum StixObservablesOrdering {
  name
  entity_type
  value
  created_at
  updated_at
}
type StixObservableConnection {
  pageInfo: PageInfo!
  edges: [StixObservableEdge]
}
type StixObservableEdge {
  cursor: String!
  node: StixObservable!
  relation: RelationEmbedded!
}
type StixObservable implements GlobalObject & StixEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  observable_value: String!
  first_seen: DateTime
  last_seen: DateTime
  description: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input StixObservableAddInput {
  internal_id: String
  stix_id: String
  type: String!
  observable_value: String!
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### STIX relations
enum StixRelationsOrdering {
  stix_id
  relationship_type
  weight
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
}
type StixRelationConnection {
  pageInfo: PageInfo!
  edges: [StixRelationEdge]
}
type StixRelationEdge {
  cursor: String!
  node: StixRelation!
  relation: RelationEmbedded
}
type StixRelation implements GlobalObject & StixEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  relationship_type: String
  inferred: Boolean
  weight: Int
  description: String
  first_seen: DateTime
  last_seen: DateTime
  created: DateTime!
  modified: DateTime!
  graph_data: String
  role_played: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  locations: IdentityConnection
  reports: ReportConnection
  from: StixEntity
  fromRole: String
  to: StixEntity
  toRole: String
  inferences: StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input StixRelationAddInput {
  internal_id: String
  stix_id: String
  fromId: String!
  fromRole: String!
  toId: String!
  toRole: String!
  relationship_type: String!
  role_played: String
  weight: Int
  description: String
  first_seen: DateTime
  last_seen: DateTime
  createdByRef: String
  markingDefinitions: [String]
  locations: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Workspace
enum WorkspacesOrdering {
  name
  created_at
  updated_at
}
type WorkspaceConnection {
  pageInfo: PageInfo!
  edges: [WorkspaceEdge]
}
type WorkspaceEdge {
  cursor: String!
  node: Workspace!
  relation: RelationEmbedded!
}
type Workspace implements GlobalObject {
  id: ID!
  internal_id: String!
  entity_type: String!
  name: String!
  description: String
  graph_data: String
  editContext: [EditUserContext]
  ownedBy: ownedBy
  markingDefinitions: MarkingDefinitionConnection
  objectRefs: StixDomainEntityConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input WorkspaceAddInput {
  name: String!
  internal_id: String
  description: String
  markingDefinitions: [String]
  clientMutationId: String
}

### Identities
enum IdentitiesOrdering {
  stix_id
  name
  created_at
  updated_at
}
type IdentityConnection {
  pageInfo: PageInfo!
  edges: [IdentityEdge]
}
type IdentityEdge {
  cursor: String!
  node: Identity!
  relation: RelationEmbedded!
}
interface Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created: DateTime
  modified: DateTime
}
input IdentityAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  type: String!
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### User
enum UsersOrdering {
  name
  email
  firstname
  lastname
  created_at
  updated_at
}
enum UserRole {
  ROLE_ROOT
  ROLE_F
  ROLE_ADMIN
}
type UserConnection {
  pageInfo: PageInfo!
  edges: [UserEdge]
}
type UserEdge {
  cursor: String!
  node: User!
}
type User implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  firstname: String
  lastname: String
  email: String
  language: String
  grant: [String]
  created: DateTime
  modified: DateTime
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  token: String
  groups: GroupConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input UserAddInput {
  internal_id: String
  stix_id: String
  email: String @constraint(minLength: 5, format: "email")
  name: String! @constraint(minLength: 3)
  description: String
  password: String
  firstname: String
  lastname: String
  language: String
  grant: [UserRole]
  createdByRef: String
  created: DateTime
  modified: DateTime
}
input PersonAddInput {
  internal_id: String
  stix_id: String
  name: String! @constraint(minLength: 3)
  description: String
  firstname: String
  lastname: String
}
input UserLoginInput {
  email: String!
  password: String!
}

### Organizations
enum OrganizationsOrdering {
  stix_id
  name
  description
  created
  modified
  created_at
  updated_at
}
type OrganizationConnection {
  pageInfo: PageInfo!
  edges: [OrganizationEdge]
}
type OrganizationEdge {
  cursor: String!
  node: Organization!
}
type Organization implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input OrganizationAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Sectors
enum SectorsOrdering {
  stix_id
  name
  description
  created
  modified
  created_at
  updated_at
}
type SectorConnection {
  pageInfo: PageInfo!
  edges: [SectorEdge]
}
type SectorEdge {
  cursor: String!
  node: Sector!
  relation: RelationEmbedded!
}
type Sector implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  subsectors: SectorConnection
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input SectorAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Cities
enum CitiesOrdering {
  stix_id
  name
  description
  created
  modified
  created_at
  updated_at
}
type CityConnection {
  pageInfo: PageInfo!
  edges: [CityEdge]
}
type CityEdge {
  cursor: String!
  node: City!
}
type City implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input CityAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Countries
enum CountriesOrdering {
  stix_id
  name
  description
  created
  modified
  created_at
  updated_at
}
type CountryConnection {
  pageInfo: PageInfo!
  edges: [CountryEdge]
}
type CountryEdge {
  cursor: String!
  node: Country!
}
type Country implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input CountryAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Regions
enum RegionsOrdering {
  stix_id
  name
  description
  created
  modified
  created_at
  updated_at
}
type RegionConnection {
  pageInfo: PageInfo!
  edges: [RegionEdge]
}
type RegionEdge {
  cursor: String!
  node: Region!
}
type Region implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input RegionAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Group
enum GroupsOrdering {
  name
  created_at
  updated_at
}
type GroupConnection {
  pageInfo: PageInfo!
  edges: [GroupEdge]
}
type GroupEdge {
  cursor: String!
  node: Group!
  relation: RelationEmbedded!
}
type Group implements GlobalObject {
  id: ID!
  internal_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  description: String
  editContext: [EditUserContext]
  members: UserConnection
  permissions: MarkingDefinitionConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input GroupAddInput {
  internal_id: String
  name: String!
  description: String
  markingDefinitions: [String]
  clientMutationId: String
}

### Marking definitions
enum MarkingDefinitionsOrdering {
  stix_id
  definition_type
  definition
  level
  color
  created
  modified
  created_at
  updated_at
}
type MarkingDefinitionConnection {
  pageInfo: PageInfo!
  edges: [MarkingDefinitionEdge]
}

type MarkingDefinitionEdge {
  cursor: String!
  node: MarkingDefinition!
  relation: RelationEmbedded!
}
type MarkingDefinition implements GlobalObject {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  definition_type: String!
  definition: String!
  level: Int
  color: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  editContext: [EditUserContext]
  created_at: DateTime!
  updated_at: DateTime!
}
input MarkingDefinitionAddInput {
  internal_id: String
  stix_id: String
  definition_type: String!
  definition: String!
  level: Int!
  color: String
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### ExternalReferences
enum ExternalReferencesOrdering {
  stix_id
  source_name
  url
  hash
  external_id
  created
  modified
  created_at
  updated_at
}
type ExternalReferenceConnection {
  pageInfo: PageInfo!
  edges: [ExternalReferenceEdge]
}

type ExternalReferenceEdge {
  cursor: String!
  node: ExternalReference!
  relation: RelationEmbedded!
}
type ExternalReference implements GlobalObject {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  source_name: String!
  description: String
  url: String
  hash: String
  external_id: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  editContext: [EditUserContext]
  created_at: DateTime!
  updated_at: DateTime!
}
input ExternalReferenceAddInput {
  internal_id: String
  stix_id: String
  source_name: String!
  description: String
  url: String
  hash: String
  external_id: String
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### KillChain Phases
enum KillChainPhasesOrdering {
  stix_id
  phase_order
  kill_chain_name
  phase_name
  created_at
  updated_at
}
type KillChainPhaseConnection {
  pageInfo: PageInfo!
  edges: [KillChainPhaseEdge]
}
type KillChainPhaseEdge {
  cursor: String!
  node: KillChainPhase!
  relation: RelationEmbedded!
}
type KillChainPhase implements GlobalObject {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  kill_chain_name: String!
  phase_name: String!
  phase_order: Int
  created: DateTime
  modified: DateTime
  revoked: Boolean
  editContext: [EditUserContext]
  markingDefinitions: MarkingDefinitionConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input KillChainPhaseAddInput {
  internal_id: String
  stix_id: String
  kill_chain_name: String!
  phase_name: String!
  phase_order: Int!
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### AttackPattern
enum AttackPatternsOrdering {
  stix_id
  name
  killChainPhases
  created
  modified
  created_at
  updated_at
}
type AttackPatternConnection {
  pageInfo: PageInfo!
  edges: [AttackPatternEdge]
}
type AttackPatternEdge {
  cursor: String!
  node: AttackPattern!
}
type AttackPattern implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  platform: [String]
  required_permission: [String]
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  externalReferences: ExternalReferenceConnection
  killChainPhases: KillChainPhaseConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input AttackPatternAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  platform: [String]
  required_permission: [String]
  createdByRef: String
  markingDefinitions: [String]
  killChainPhases: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### CourseOfAction
enum CourseOfActionsOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type CourseOfActionConnection {
  pageInfo: PageInfo!
  edges: [CourseOfActionEdge]
}
type CourseOfActionEdge {
  cursor: String!
  node: CourseOfAction!
}
type CourseOfAction implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input CourseOfActionAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Threat Actors
enum ThreatActorsOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type ThreatActorConnection {
  pageInfo: PageInfo!
  edges: [ThreatActorEdge]
}
type ThreatActorEdge {
  cursor: String!
  node: ThreatActor!
}
type ThreatActor implements GlobalObject & StixEntity & StixDomainEntity & Identity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  stix_role: String
  goal: String
  sophistication: String
  resource_level: String
  primary_motivation: String
  secondary_motivation: String
  personal_motivation: String
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input ThreatActorAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  goal: String
  sophistication: String
  resource_level: String
  primary_motivation: String
  secondary_motivation: String
  personal_motivation: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### IntrusionSets
enum IntrusionSetsOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type IntrusionSetConnection {
  pageInfo: PageInfo!
  edges: [IntrusionSetEdge]
}
type IntrusionSetEdge {
  cursor: String!
  node: IntrusionSet!
}
type IntrusionSet implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  first_seen: DateTime
  last_seen: DateTime
  goal: String
  sophistication: String
  resource_level: String
  primary_motivation: String
  secondary_motivation: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input IntrusionSetAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  first_seen: DateTime
  last_seen: DateTime
  goal: String
  sophistication: String
  resource_level: String
  primary_motivation: String
  secondary_motivation: String
  personal_motivation: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Campaign
enum CampaignsOrdering {
  stix_id
  name
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
}
type CampaignConnection {
  pageInfo: PageInfo!
  edges: [CampaignEdge]
}
type CampaignEdge {
  cursor: String!
  node: Campaign!
}
type Campaign implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  first_seen: DateTime
  last_seen: DateTime
  objective: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input CampaignAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  first_seen: DateTime
  last_seen: DateTime
  objective: String
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Incident
enum IncidentsOrdering {
  stix_id
  name
  first_seen
  last_seen
  created
  modified
  created_at
  updated_at
}
type IncidentConnection {
  pageInfo: PageInfo!
  edges: [IncidentEdge]
}
type IncidentEdge {
  cursor: String!
  node: Incident!
}
type Incident implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  first_seen: DateTime
  last_seen: DateTime
  objective: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input IncidentAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  objective: String
  first_seen: DateTime
  last_seen: DateTime
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Malware
enum MalwaresOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type MalwareConnection {
  pageInfo: PageInfo!
  edges: [MalwareEdge]
}
type MalwareEdge {
  cursor: String!
  node: Malware!
}
type Malware implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  killChainPhases: KillChainPhaseConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input MalwareAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  createdByRef: String
  markingDefinitions: [String]
  killChainPhases: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Tool
enum ToolsOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type ToolConnection {
  pageInfo: PageInfo!
  edges: [ToolEdge]
}
type ToolEdge {
  cursor: String!
  node: Tool!
}
type Tool implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  tool_version: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  killChainPhases: KillChainPhaseConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input ToolAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  tool_version: String
  createdByRef: String
  markingDefinitions: [String]
  killChainPhases: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Vulnerability
enum VulnerabilitiesOrdering {
  stix_id
  name
  created
  modified
  created_at
  updated_at
}
type VulnerabilityConnection {
  pageInfo: PageInfo!
  edges: [VulnerabilityEdge]
}
type VulnerabilityEdge {
  cursor: String!
  node: Vulnerability!
}
type Vulnerability implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  alias: [String]
  description: String
  created: DateTime
  modified: DateTime
  revoked: Boolean
  graph_data: String
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  reports: ReportConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input VulnerabilityAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String!
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Reports
enum ReportsOrdering {
  stix_id
  name
  created
  modified
  published
  object_status
  createdByRef
  created_at
  updated_at
}
type ReportConnection {
  pageInfo: PageInfo!
  edges: [ReportEdge]
}
type ReportEdge {
  cursor: String!
  node: Report!
  relation: RelationEmbedded!
}
type ReportPayload {
  reportEdge: ReportEdge
}
type Report implements GlobalObject & StixEntity & StixDomainEntity {
  id: ID!
  internal_id: String!
  stix_id: String!
  entity_type: String!
  parent_type: String!
  name: String!
  stix_label: [String]
  description: String
  report_class: String
  alias: [String]
  graph_data: String
  created: DateTime
  modified: DateTime
  published: DateTime
  revoked: Boolean
  object_status: Int
  source_confidence_level: Int
  editContext: [EditUserContext]
  createdByRef: createdByRef
  markingDefinitions: MarkingDefinitionConnection
  externalReferences: ExternalReferenceConnection
  objectRefs: StixDomainEntityConnection
  observableRefs: StixObservableConnection
  relationRefs(relationType: String): StixRelationConnection
  exports(types: [String]!): [Export]
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection
  created_at: DateTime!
  updated_at: DateTime!
}
input ReportAddInput {
  internal_id: String
  stix_id: String
  name: String!
  description: String
  published: DateTime
  report_class: String
  graph_data: String
  object_status: Int
  source_confidence_level: Int
  createdByRef: String
  markingDefinitions: [String]
  clientMutationId: String
  created: DateTime
  modified: DateTime
}

### Relations
input RelationAddInput {
  internal_id: String
  stix_id: String
  fromRole: String!
  toId: ID!
  toRole: String!
  through: String!
  first_seen: DateTime
  last_seen: DateTime
  description: String
  weight: Int
}
input RelationsAddInput {
  fromRole: String!
  toIds: [ID]!
  toRole: String!
  through: String!
}

### QUERIES
type Query {
  # Settings
  settings: Settings
  # StixDomainEntities
  stixDomainEntity(id: String): StixDomainEntity @auth
  stixDomainEntities(
    first: Int
    after: ID
    orderBy: StixDomainEntitiesOrdering
    orderMode: OrderingMode
    name: String
    names: [String]
    stix_id: String
    search: String
    externalReferenceId: String
    type: String
  ): StixDomainEntityConnection @auth
  stixDomainEntitiesTimeSeries(
    type: String
    field: String!
    operation: StatsOperation!
    startDate: DateTime!
    endDate: DateTime!
    interval: String!
  ): [TimeSeries] @auth
  stixDomainEntitiesNumber(type: String, endDate: DateTime): Number @auth
  # StixObservables
  stixObservable(id: String): StixObservable @auth
  stixObservables(
    first: Int
    after: ID
    orderBy: StixObservablesOrdering
    orderMode: OrderingMode
    types: [String]
    observable_value: String
    search: String
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
  ): StixObservableConnection @auth
  stixObservablesTimeSeries(type: String): [TimeSeries] @auth
  stixObservablesDistribution(type: String): [Distribution] @auth
  # StixRelations
  stixRelation(id: String!): StixRelation @auth
  stixRelations(
    first: Int
    after: ID
    orderBy: StixRelationsOrdering
    orderMode: OrderingMode
    stix_id: String
    fromId: String
    inferred: Boolean
    toId: String
    fromTypes: [String]
    toTypes: [String]
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    firstSeenStart: DateTime
    firstSeenStop: DateTime
    lastSeenStart: DateTime
    lastSeenStop: DateTime
    weights: [Int]
    search: String
    infrastructure: Boolean
  ): StixRelationConnection @auth
  stixRelationsTimeSeries(
    fromId: String
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    entityTypes: [String]
    toTypes: [String]
    field: String!
    operation: StatsOperation!
    startDate: DateTime!
    endDate: DateTime!
    interval: String!
  ): [TimeSeries] @auth
  stixRelationsDistribution(
    fromId: String
    relationType: String
    resolveInferences: Boolean
    resolveRelationType: String
    resolveRelationRole: String
    resolveRelationToTypes: [String]
    resolveViaTypes: [EntityRelation]
    entityTypes: [String]
    toTypes: [String]
    startDate: DateTime
    endDate: DateTime
    field: String!
    operation: StatsOperation!
    limit: Int
    order: String
  ): [Distribution] @auth
  # Workspaces
  workspace(id: String!): Workspace @auth
  workspaces(
    first: Int
    after: ID
    orderBy: WorkspacesOrdering
    orderMode: OrderingMode
    search: String
  ): WorkspaceConnection @auth
  # Identities
  identity(id: String!): Identity @auth
  identities(
    first: Int
    after: ID
    orderBy: IdentitiesOrdering
    orderMode: OrderingMode
    search: String
  ): IdentityConnection @auth
  # Users
  me: User @auth
  user(id: String!): User @auth
  users(
    first: Int
    after: ID
    orderBy: UsersOrdering
    orderMode: OrderingMode
    search: String
    isUser: Boolean
  ): UserConnection @auth
  # Organizations
  organization(id: String!): Organization @auth
  organizations(
    first: Int
    after: ID
    orderBy: OrganizationsOrdering
    orderMode: OrderingMode
    search: String
  ): OrganizationConnection @auth
  # Sectors
  sector(id: String!): Sector @auth
  sectors(
    first: Int
    after: ID
    orderBy: SectorsOrdering
    orderMode: OrderingMode
    search: String
  ): SectorConnection @auth
  # Cities
  city(id: String!): City @auth
  cities(
    first: Int
    after: ID
    orderBy: CitiesOrdering
    orderMode: OrderingMode
    search: String
  ): CityConnection @auth
  # Countries
  country(id: String!): Country @auth
  countries(
    first: Int
    after: ID
    orderBy: CountriesOrdering
    orderMode: OrderingMode
    search: String
  ): CountryConnection @auth
  # Regions
  region(id: String!): Region @auth
  regions(
    first: Int
    after: ID
    orderBy: RegionsOrdering
    orderMode: OrderingMode
    search: String
  ): RegionConnection @auth
  # Groups
  group(id: String!): Group @auth
  groups(
    first: Int
    after: ID
    orderBy: GroupsOrdering
    orderMode: OrderingMode
    search: String
  ): GroupConnection @auth
  # MarkingDefinitions
  markingDefinition(id: String!): MarkingDefinition @auth
  markingDefinitions(
    first: Int
    after: ID
    orderBy: MarkingDefinitionsOrdering
    orderMode: OrderingMode
    definition_type: String
    definition: String
    stix_id: String
    objectId: String
    search: String
  ): MarkingDefinitionConnection @auth
  # ExternalReferences
  externalReference(id: String!): ExternalReference @auth
  externalReferences(
    first: Int
    after: ID
    orderBy: ExternalReferencesOrdering
    orderMode: OrderingMode
    objectId: String
    search: String
  ): ExternalReferenceConnection @auth
  # KillChainPhases
  killChainPhase(id: String!): KillChainPhase @auth
  killChainPhases(
    first: Int
    after: ID
    orderBy: KillChainPhasesOrdering
    orderMode: OrderingMode
    objectId: String
    search: String
    phaseName: String
  ): KillChainPhaseConnection @auth
  # AttackPatterns
  attackPattern(id: String!): AttackPattern @auth
  attackPatterns(
    first: Int
    after: ID
    orderBy: AttackPatternsOrdering
    orderMode: OrderingMode
    search: String
  ): AttackPatternConnection @auth
  # CourseOfActions
  courseOfAction(id: String!): CourseOfAction @auth
  courseOfActions(
    first: Int
    after: ID
    orderBy: CourseOfActionsOrdering
    orderMode: OrderingMode
    search: String
  ): CourseOfActionConnection @auth
  # ThreatActors
  threatActor(id: String!): ThreatActor @auth
  threatActors(
    first: Int
    after: ID
    orderBy: ThreatActorsOrdering
    orderMode: OrderingMode
    search: String
  ): ThreatActorConnection @auth
  # IntursionSets
  intrusionSet(id: String!): IntrusionSet @auth
  intrusionSets(
    first: Int
    after: ID
    orderBy: IntrusionSetsOrdering
    orderMode: OrderingMode
    search: String
  ): IntrusionSetConnection @auth
  # Campaigns
  campaign(id: String!): Campaign @auth
  campaigns(
    first: Int
    after: ID
    orderBy: CampaignsOrdering
    orderMode: OrderingMode
    search: String
  ): CampaignConnection @auth
  campaignsTimeSeries(
    objectId: String
    field: String!
    operation: StatsOperation!
    startDate: DateTime!
    endDate: DateTime!
    interval: String!
  ): [TimeSeries] @auth
  # Incidents
  incident(id: String!): Incident @auth
  incidents(
    first: Int
    after: ID
    orderBy: IncidentsOrdering
    orderMode: OrderingMode
    search: String
  ): IncidentConnection @auth
  incidentsTimeSeries(
    objectId: String
    field: String!
    operation: StatsOperation!
    startDate: DateTime!
    endDate: DateTime!
    interval: String!
  ): [TimeSeries] @auth
  # Malwares
  malware(id: String!): Malware @auth
  malwares(
    first: Int
    after: ID
    orderBy: MalwaresOrdering
    orderMode: OrderingMode
    search: String
  ): MalwareConnection @auth
  # Tools
  tool(id: String!): Tool @auth
  tools(
    first: Int
    after: ID
    orderBy: ToolsOrdering
    orderMode: OrderingMode
    search: String
  ): ToolConnection @auth
  # Vulnerabilities
  vulnerability(id: String!): Vulnerability @auth
  vulnerabilities(
    first: Int
    after: ID
    orderBy: VulnerabilitiesOrdering
    orderMode: OrderingMode
    search: String
  ): VulnerabilityConnection @auth
  # Reports
  report(id: String!): Report @auth
  reports(
    first: Int
    after: ID
    orderBy: ReportsOrdering
    orderMode: OrderingMode
    objectId: String
    reportClass: String
    search: String
  ): ReportConnection @auth
  reportsTimeSeries(
    objectId: String
    reportClass: String
    field: String!
    operation: StatsOperation!
    startDate: DateTime!
    endDate: DateTime!
    interval: String!
  ): [TimeSeries] @auth
}

### SUBSCRIPTIONS
type Subscription {
  settings(id: ID!): Settings @auth(for: ROLE_ADMIN)
  markingDefinition(id: ID!): MarkingDefinition @auth(for: ROLE_ADMIN)
  killChainPhase(id: ID!): KillChainPhase @auth(for: ROLE_ADMIN)
  stixDomainEntity(id: ID!): StixDomainEntity @auth
  stixObservable(id: ID!): StixObservable @auth
  stixRelation(id: ID!): StixRelation @auth
  workspace(id: ID!): Workspace @auth
  externalReference(id: ID!): ExternalReference @auth
}

### MUTATIONS
# Settings
type SettingsEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Settings
  contextPatch(input: EditContext): Settings
  contextClean: Settings
}

# StixDomain
type StixDomainEntityEditMutations {
  delete: ID
  fieldPatch(input: EditInput): StixDomainEntity
  contextPatch(input: EditContext): StixDomainEntity
  contextClean: StixDomainEntity
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
  refreshExport(entityType: String!, type: String!): StixDomainEntity
  exportPush(exportId: String!, rawData: String!): Boolean @auth(for: ROLE_ADMIN)
}

# StixObservable
type StixObservableEditMutations {
  delete: ID
  fieldPatch(input: EditInput): StixObservable
  contextPatch(input: EditContext): StixObservable
  contextClean: StixObservable
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# StixRelation
type StixRelationEditMutations {
  delete: ID
  fieldPatch(input: EditInput): StixRelation
  contextPatch(input: EditContext): StixRelation
  contextClean: StixRelation
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Workspace
type WorkspaceEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Workspace
  contextPatch(input: EditContext): Workspace
  contextClean: Workspace
  relationAdd(input: RelationAddInput): RelationData
  relationsAdd(input: RelationsAddInput): Workspace
  relationDelete(relationId: ID!): RelationData
}

# Identity
type IdentityEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Identity
  contextPatch(input: EditContext): Identity
  contextClean: Identity
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# User
type UserEditMutations {
  delete: ID
  fieldPatch(input: EditInput): User
  contextPatch(input: EditContext): User
  contextClean: User
  tokenRenew: User
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Organization
type OrganizationEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Organization
  contextPatch(input: EditContext): Organization
  contextClean: Organization
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Sector
type SectorEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Sector
  contextPatch(input: EditContext): Sector
  contextClean: Sector
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# City
type CityEditMutations {
  delete: ID
  fieldPatch(input: EditInput): City
  contextPatch(input: EditContext): City
  contextClean: City
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Country
type CountryEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Country
  contextPatch(input: EditContext): Country
  contextClean: Country
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Region
type RegionEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Region
  contextPatch(input: EditContext): Region
  contextClean: Region
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Group
type GroupEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Group
  contextPatch(input: EditContext): Group
  contextClean: Group
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# MarkingDefinition
type MarkingDefinitionEditMutations {
  delete: ID
  fieldPatch(input: EditInput): MarkingDefinition
  contextPatch(input: EditContext): MarkingDefinition
  contextClean: MarkingDefinition
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# ExternalReference
type ExternalReferenceEditMutations {
  delete: ID
  fieldPatch(input: EditInput): ExternalReference
  contextPatch(input: EditContext): ExternalReference
  contextClean: ExternalReference
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# KillChainPhase
type KillChainPhaseEditMutations {
  delete: ID
  fieldPatch(input: EditInput): KillChainPhase
  contextPatch(input: EditContext): KillChainPhase
  contextClean: KillChainPhase
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# AttackPattern
type AttackPatternEditMutations {
  delete: ID
  fieldPatch(input: EditInput): AttackPattern
  contextPatch(input: EditContext): AttackPattern
  contextClean: AttackPattern
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# CourseOfAction
type CourseOfActionEditMutations {
  delete: ID
  fieldPatch(input: EditInput): CourseOfAction
  contextPatch(input: EditContext): CourseOfAction
  contextClean: CourseOfAction
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# ThreatActor
type ThreatActorEditMutations {
  delete: ID
  fieldPatch(input: EditInput): ThreatActor
  contextPatch(input: EditContext): ThreatActor
  contextClean: ThreatActor
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# IntrusionSet
type IntrusionSetEditMutations {
  delete: ID
  fieldPatch(input: EditInput): IntrusionSet
  contextPatch(input: EditContext): IntrusionSet
  contextClean: IntrusionSet
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Campaign
type CampaignEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Campaign
  contextPatch(input: EditContext): Campaign
  contextClean: Campaign
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Incident
type IncidentEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Incident
  contextPatch(input: EditContext): Incident
  contextClean: Incident
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Malware
type MalwareEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Malware
  contextPatch(input: EditContext): Malware
  contextClean: Malware
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Tool
type ToolEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Tool
  contextPatch(input: EditContext): Tool
  contextClean: Tool
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Vulnerability
type VulnerabilityEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Vulnerability
  contextPatch(input: EditContext): Vulnerability
  contextClean: Vulnerability
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Report
type ReportEditMutations {
  delete: ID
  fieldPatch(input: EditInput): Report
  contextPatch(input: EditContext): Report
  contextClean: Report
  relationAdd(input: RelationAddInput): RelationData
  relationDelete(relationId: ID!): RelationData
}

# Mutations
type Mutation {
  # Login
  token(input: UserLoginInput): String
  # Settings
  settingsAdd(input: SettingsAddInput): Settings @auth(for: ROLE_ADMIN)
  settingsEdit(id: ID!): SettingsEditMutations @auth(for: ROLE_ADMIN)
  # Import data
  importData(type: String!, file: Upload!): Boolean @auth
  # StixDomainEntity
  stixDomainEntityAdd(input: StixDomainEntityAddInput): StixDomainEntity @auth
  stixDomainEntityEdit(id: ID!): StixDomainEntityEditMutations @auth
  # StixObservable
  stixObservableAdd(input: StixObservableAddInput): StixObservable @auth
  stixObservableEdit(id: ID!): StixObservableEditMutations @auth
  # StixRelation
  stixRelationAdd(input: StixRelationAddInput): StixRelation @auth
  stixRelationEdit(id: ID!): StixRelationEditMutations @auth
  # Workspace
  workspaceAdd(input: WorkspaceAddInput): Workspace @auth
  workspaceEdit(id: ID!): WorkspaceEditMutations @auth
  # Identity
  identityAdd(input: IdentityAddInput): Identity @auth
  identityEdit(id: ID!): IdentityEditMutations @auth
  # User
  userAdd(input: UserAddInput): User @auth(for: ROLE_ADMIN)
  personAdd(input: PersonAddInput): User @auth
  userEdit(id: ID!): UserEditMutations @auth(for: ROLE_ADMIN)
  meEdit(input: EditInput): User @auth
  logout: ID @auth
  # Organization
  organizationAdd(input: OrganizationAddInput): Organization @auth
  organizationEdit(id: ID!): OrganizationEditMutations @auth
  # Sector
  sectorAdd(input: SectorAddInput): Sector @auth
  sectorEdit(id: ID!): SectorEditMutations @auth
  # City
  cityAdd(input: CityAddInput): City @auth
  cityEdit(id: ID!): CityEditMutations @auth
  # Country
  countryAdd(input: CountryAddInput): Country @auth
  countryEdit(id: ID!): CountryEditMutations @auth
  # Region
  regionAdd(input: RegionAddInput): Region @auth
  regionEdit(id: ID!): RegionEditMutations @auth
  # Group
  groupAdd(input: GroupAddInput): Group @auth(for: ROLE_ADMIN)
  groupEdit(id: ID!): GroupEditMutations @auth(for: ROLE_ADMIN)
  # MarkingDefinition
  markingDefinitionAdd(input: MarkingDefinitionAddInput): MarkingDefinition
    @auth(for: ROLE_ADMIN)
  markingDefinitionEdit(id: ID!): MarkingDefinitionEditMutations
    @auth(for: ROLE_ADMIN)
  # ExternalReference
  externalReferenceAdd(input: ExternalReferenceAddInput): ExternalReference
    @auth
  externalReferenceEdit(id: ID!): ExternalReferenceEditMutations @auth
  # KillChainPhase
  killChainPhaseAdd(input: KillChainPhaseAddInput): KillChainPhase
    @auth(for: ROLE_ADMIN)
  killChainPhaseEdit(id: ID!): KillChainPhaseEditMutations
    @auth(for: ROLE_ADMIN)
  # AttackPattern
  attackPatternAdd(input: AttackPatternAddInput): AttackPattern @auth
  attackPatternEdit(id: ID!): AttackPatternEditMutations @auth
  # CourseOfAction
  courseOfActionAdd(input: CourseOfActionAddInput): CourseOfAction @auth
  courseOfActionEdit(id: ID!): CourseOfActionEditMutations @auth
  # ThreatActor
  threatActorAdd(input: ThreatActorAddInput): ThreatActor @auth
  threatActorEdit(id: ID!): ThreatActorEditMutations @auth
  # IntrusionSet
  intrusionSetAdd(input: IntrusionSetAddInput): IntrusionSet @auth
  intrusionSetEdit(id: ID!): IntrusionSetEditMutations @auth
  # Campaign
  campaignAdd(input: CampaignAddInput): Campaign @auth
  campaignEdit(id: ID!): CampaignEditMutations @auth
  # Incident
  incidentAdd(input: IncidentAddInput): Incident @auth
  incidentEdit(id: ID!): IncidentEditMutations @auth
  # Malware
  malwareAdd(input: MalwareAddInput): Malware @auth
  malwareEdit(id: ID!): MalwareEditMutations @auth
  # Tool
  toolAdd(input: ToolAddInput): Tool @auth
  toolEdit(id: ID!): ToolEditMutations @auth
  # Vulnerability
  vulnerabilityAdd(input: VulnerabilityAddInput): Vulnerability @auth
  vulnerabilityEdit(id: ID!): VulnerabilityEditMutations @auth
  # Report
  reportAdd(input: ReportAddInput): Report @auth
  reportEdit(id: ID!): ReportEditMutations @auth
}
